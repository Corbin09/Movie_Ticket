<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title> Home </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/home.css}" />
</head>

<body>

<!-- Header -->
<div th:replace="fragments/header :: header"></div>

<!-- Hero Banner -->
<div class="hero-banner">
    <div class="hero-slider">
        <img th:each="film, stat : ${nowShowingMovies}" th:if="${stat.index < 3}"
             th:src="@{${film.filmImg}}" alt="Featured Movie"
             class="hero-image" th:classappend="${stat.index == 0} ? 'active' : ''">
    </div>

    <!-- Pagination Default -->
    <div class="pagination-default">
        <div th:each="film, stat : ${nowShowingMovies}" th:if="${stat.index < 3}"
             class="pagination-dot" th:classappend="${stat.index == 0} ? 'active' : ''"></div>
    </div>
</div>

<!-- Now Showing Section -->
<div class="movie-section">
    <h2 class="section-title">Now Showing</h2>
    <div class="movie-grid">
        <div th:each="film : ${nowShowingMovies}" class="movie-card">
            <a th:href="@{'/films/' + ${film.filmId}}">
                <div class="movie-poster-container">
                    <img th:src="${film.filmImg}" th:alt="${film.filmName}" class="movie-poster"/>
                </div>
                <div class="movie-info">
                    <div class="movie-meta">
                        <span class="movie-category" th:text="${film.filmType}">Horror</span>
                        <span class="movie-release-date"
                              th:text="${#dates.format(film.releaseDate, 'dd/MM/yyyy')}">28/02/2025</span>
                        <span class="movie-duration" th:text="${film.duration + ' min'}">114 min</span>
                    </div>
                    <div class="movie-title" th:text="${film.filmName}">DARK NUNS - T13 - 2D</div>
                </div>
            </a>
        </div>
    </div>

    <!-- Pagination for Now Showing -->
    <div class="pagination" id="pagibar-now-showing">
        <a th:if="${currentPageNowShowing > 1}"
           th:href="@{/home(currentPageNowShowing=${currentPageNowShowing - 1}, currentPageComingSoon=${currentPageComingSoon})}"
           class="prev">‹</a>

        <a th:each="i : ${#numbers.sequence(1, totalPagesNowShowing)}"
           th:href="@{/home(currentPageNowShowing=${i}, currentPageComingSoon=${currentPageComingSoon})}"
           th:classappend="${currentPageNowShowing == i} ? 'active' : ''"
           th:text="${i}"></a>

        <a th:if="${currentPageNowShowing < totalPagesNowShowing}"
           th:href="@{/home(currentPageNowShowing=${currentPageNowShowing + 1}, currentPageComingSoon=${currentPageComingSoon})}"
           class="next">›</a>
    </div>
</div>

<!-- Coming Soon Section -->
<div class="movie-section">
    <h2 class="section-title">Coming Soon</h2>
    <div class="movie-grid">
        <div th:each="film : ${comingSoonMovies}" class="movie-card">
            <a th:href="@{'/films/' + ${film.filmId}}">
                <div class="movie-poster-container">
                    <img th:src="${film.filmImg}" th:alt="${film.filmName}" class="movie-poster"/>
                </div>
                <div class="movie-info">
                    <div class="movie-meta">
                        <span class="movie-category" th:text="${film.filmType}">Adventure</span>
                        <span class="movie-release-date"
                              th:text="${#dates.format(film.releaseDate, 'dd/MM/yyyy')}">14/02/2025</span>
                        <span class="movie-duration" th:text="${film.duration + ' min'}">114 min</span>
                    </div>
                    <div class="movie-title" th:text="${film.filmName}">CAPTAIN AMERICA - T13 - 2D</div>
                </div>
            </a>
        </div>
    </div>

    <!-- Pagination for Coming Soon -->
    <div class="pagination" id="pagibar-coming-soon">
        <a th:if="${currentPageComingSoon > 1}"
           th:href="@{/home(currentPageNowShowing=${currentPageNowShowing}, currentPageComingSoon=${currentPageComingSoon - 1})}"
           class="prev">‹</a>

        <a th:each="i : ${#numbers.sequence(1, totalPagesComingSoon)}"
           th:href="@{/home(currentPageNowShowing=${currentPageNowShowing}, currentPageComingSoon=${i})}"
           th:classappend="${currentPageComingSoon == i} ? 'active' : ''"
           th:text="${i}"></a>

        <a th:if="${currentPageComingSoon < totalPagesComingSoon}"
           th:href="@{/home(currentPageNowShowing=${currentPageNowShowing}, currentPageComingSoon=${currentPageComingSoon + 1})}"
           class="next">›</a>
    </div>
</div>

<!-- Footer -->
<div th:replace="fragments/footer :: footer"></div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const slides = document.querySelectorAll('.hero-image');
        const dots = document.querySelectorAll('.pagination-dot');
        let currentSlide = 0;

        function changeSlide() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
                dots[index]?.classList.remove('active');
            });
            slides[currentSlide].classList.add('active');
            dots[currentSlide]?.classList.add('active');
        }

        setInterval(() => {
            currentSlide = (currentSlide + 1) % slides.length;
            changeSlide();
        }, 3000);

        dots.forEach((dot, index) => {
            dot.addEventListener('click', function () {
                currentSlide = index;
                changeSlide();
            });
        });

        changeSlide();
    });
</script>

</body>
</html>
